{% extends 'glasmarket/base.html' %}
{% load staticfiles %}


{% block title_block %}
{% if user.is_authenticated %}
    {{ user.username }}
{% else %}
    Profile
{% endif %}

{% endblock %}

{% block body_block %}

    {% if user.is_superuser %}
        you are an admin 
        <a href="{% url 'glasmarket:logout' %}">Logout</a>
    {% else %}
    <div id="userPage">

        <div id="picAndInfo">

            {% if profile.picture %}
                <img src="{{ MEDIA_URL }}{{ profile.picture }}" alt="userPicture">
            {% else %}
                <img src="{% static 'images/stockProfile.png' %}" alt="userPicture">
            {% endif %}
            
            <h1>{{ pageUser.username }}</h1>
            
            
            <div id="userInfo">


                {% if user.username ==  pageUser.username %}
                    <h2>Your contact details</h2>
                {% else %}
                    <h2>Contact {{ pageUser.username }}</h2><br>
                {% endif %}
                
                email:  {{ pageUser.email }}<br>
                
                {% if profile.phone %}
                    phone number:  {{ profile.phone }}<br>
                {% endif %}
                
                {% if profile.facebook %}
                
                <a href="{{ profile.facebook }}">go to {{ pageUser.username }}'s facebook</a> <br><br>
                
                {% endif %}
            
            </div>
            {% if user.username ==  pageUser.username %} 

                    <a id="editButton" href="{% url 'glasmarket:editUser' pageUser.username %}">Edit Profile</a>
                    
                
                    <a id="logoutButton" onclick="return confirmLogout()" href="{% url 'glasmarket:logout' %}">Logout</a>
                {% endif %}
            

        </div>

        <div id="userListings"></div>
            <div id="profileHead">
            {% if user.username == pageUser.username %}
                <h1>Your listings </h1><a href="{% url 'glasmarket:addListing' pageUser.username %}">+</a>
                
                
            {% else %}
                <h1>{{ pageUser.username }}'s listings</h1>
            {% endif %}
            </div>
            
                {% if listings %}
                    {% for listing in listings %}
                        
                        <div class="product">
                            <div class="image" >  
                                {% if listing.picture != '0' %}
                                    <img src="{{ MEDIA_URL }}{{ listing.picture }}" class="myImg">
                                {% else %}
                                    <img src="{% static 'images/noImage.jpg' %}" class="myImg">
                                {% endif %}
                            </div>
                        
                            <div id="info">
                                <h1>{{ listing.name }}</h1>
                                <h3>{{ listing.price }}Â£</h3>
                                {% if user.username == pageUser.username %}
                                    <a id="deleteListing" onclick="return confirmDelete('{{ listing.name }}')" href="{% url 'glasmarket:removeListing' pageUser.username listing.id  %}">Delete Listing</a>
                                {% endif %}
                            </div>

                            <div class="description">
                                <p>{{ listing.description }}</p>        
                            </div>
                        </div>

                    {% endfor %}

                {% else %}
                    {% if user.username == pageUser.username %}
                    <h3>You dont't have any listings,<a href="{% url 'glasmarket:addListing' pageUser.username %}">add one?</a></h3>
                    {% else %}
                    <h3>{{ pageUser.username }} doesn't have any listings</h3>
                    {% endif %}
                {% endif %}
            
        </div>
        <div id="myModal" class="modal">
            <span class="close">&times;</span>
            <img class="modal-content" id="img01">
            <div id="caption"></div>
            </div>
    </div>
    {% endif %}
    
{% endblock %}  